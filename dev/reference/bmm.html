<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit Bayesian Measurement Models — bmm • bmm</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Bayesian Measurement Models — bmm"><meta name="description" content="Fit a Bayesian measurement model using brms as a
backend interface to Stan."><meta property="og:description" content="Fit a Bayesian measurement model using brms as a
backend interface to Stan."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bmm</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="https://venpopov.github.io/bmm/dev-notes/index.html">Develop</a></li>
<li class="nav-item"><a class="nav-link" href="https://venpopov.github.io/bmm/parameter-recovery/index.html">Parameter recovery</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/venpopov/bmm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit Bayesian Measurement Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/venpopov/bmm/blob/develop/R/bmm.R" class="external-link"><code>R/bmm.R</code></a></small>
      <div class="d-none name"><code>bmm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit a Bayesian measurement model using <strong>brms</strong> as a
backend interface to Stan.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bmm</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  prior <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sort_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"bmm.sort_data"</span>, <span class="st">"check"</span><span class="op">)</span>,</span>
<span>  silent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"bmm.silent"</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  backend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"brms.backend"</span>, <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  file_compress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  file_refit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"bmm.file_refit"</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fit_model</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  prior <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sort_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"bmm.sort_data"</span>, <span class="st">"check"</span><span class="op">)</span>,</span>
<span>  silent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"bmm.silent"</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  backend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"brms.backend"</span>, <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>An object of class <code>bmmformula</code>. A symbolic description of the
model to be fitted.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>An object of class data.frame, containing data of all variables
used in the model. The names of the variables must match the variable names
passed to the <code>bmmodel</code> object for required argurments.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A description of the model to be fitted. This is a call to a
<code>bmmodel</code> such as <code><a href="mixture3p.html">mixture3p()</a></code> function. Every model function has a
number of required arguments which need to be specified within the function
call. Call <code><a href="supported_models.html">supported_models()</a></code> to see the list of supported models and
their required arguments</p></dd>


<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>One or more <code>brmsprior</code> objects created by <code><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">brms::set_prior()</a></code>
or related functions and combined using the c method or the + operator. See
also <code><a href="default_prior.bmmformula.html">default_prior()</a></code> for more help. Not necessary for the default model
fitting, but you can provide prior constraints to model parameters</p></dd>


<dt id="arg-sort-data">sort_data<a class="anchor" aria-label="anchor" href="#arg-sort-data"></a></dt>
<dd><p>Logical. If TRUE, the data will be sorted by the predictor
variables for faster sampling. If FALSE, the data will not be sorted, but
sampling will be slower. If "check" (the default), <code>bmm()</code> will check if
the data is sorted, and ask you via a console prompt if it should be
sorted. You can set the default value for this option using global
<code>options(bmm.sort_data = TRUE/FALSE/"check"))</code> or via <code>bmm_options(sort_data)</code></p></dd>


<dt id="arg-silent">silent<a class="anchor" aria-label="anchor" href="#arg-silent"></a></dt>
<dd><p>Verbosity level between 0 and 2. If 1 (the default), most of the
informational messages of compiler and sampler are suppressed. If 2, even
more messages are suppressed. The actual sampling progress is still
printed. Set refresh = 0 to turn this off as well. If using backend =
"rstan" you can also set open_progress = FALSE to prevent opening
additional progress bars.</p></dd>


<dt id="arg-backend">backend<a class="anchor" aria-label="anchor" href="#arg-backend"></a></dt>
<dd><p>Character. The backend to use for fitting the model. Can be
"rstan" or "cmdstanr". If NULL (the default), "cmdstanr" will be used if
the cmdstanr package is installed, otherwise "rstan" will be used. You can
set the default backend using global <code>options(brms.backend = "rstan"/"cmdstanr")</code></p></dd>


<dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>Either <code>NULL</code> or a character string. If a string, the fitted
model object is saved via <a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a> in a file named after the string. The
.rds extension is added automatically. If the file already exists, <code>bmm</code>
will load and return the saved model object. Unless you specify the
<code>file_refit</code> argument as well, the existing files won't be overwritten, you
have to manually remove the file in order to refit and save the model under
an existing file name. The file name is stored in the <code>bmmfit</code> object for
later usage. If the directory of the file does not exist, it will be created.</p></dd>


<dt id="arg-file-compress">file_compress<a class="anchor" aria-label="anchor" href="#arg-file-compress"></a></dt>
<dd><p>Logical or a character string, specifying one of the
compression algorithms supported by <a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a> when saving
the fitted model object.</p></dd>


<dt id="arg-file-refit">file_refit<a class="anchor" aria-label="anchor" href="#arg-file-refit"></a></dt>
<dd><p>Logical or character string. Modifies when the fit stored via the <code>file</code> argument is
re-used. Can be set globally for the current R session via the
<code>"bmm.file_refit"</code> option (see <a href="https://rdrr.io/r/base/options.html" class="external-link">options</a>). If <code>TRUE</code> or "always", the
model is fitted again. If <code>FALSE</code> or "never" (the default), the model saved under the name specified in <code>file</code>
will be re-used. Note that unlike in <code>brms</code>, there is no "on_change" option</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to <code><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brms::brm()</a></code> or Stan. See the
description of <code><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brms::brm()</a></code> for more details</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class brmsfit which contains the posterior draws along
with many other useful information about the model. Use methods(class =
"brmsfit") for an overview on available methods.</p>
    </div>
    <div class="section level2">
    <h2 id="supported-models">Supported Models<a class="anchor" aria-label="anchor" href="#supported-models"></a></h2>
    <p>The following models are supported:</p><ul><li><p>imm(resp_error, nt_features, nt_distances, set_size, regex, version)</p></li>
<li><p>m3(resp_cats, num_options, choice_rule, version)</p></li>
<li><p>mixture2p(resp_error)</p></li>
<li><p>mixture3p(resp_error, nt_features, set_size, regex)</p></li>
<li><p>sdm(resp_error, version)</p></li>
</ul><p>Type  ?modelname  to get information about a specific model, e.g.  ?imm</p>
    </div>
    <div class="section level2">
    <h2 id="bmmformula-syntax">bmmformula syntax<a class="anchor" aria-label="anchor" href="#bmmformula-syntax"></a></h2>
    <p>see <a href="https://venpopov.github.io/bmm/articles/bmm_bmmformula.html">this online article</a> for a detailed description of the syntax and how
it differs from the syntax for <strong>brmsformula</strong></p>
    </div>
    <div class="section level2">
    <h2 id="default-priors-stan-code-and-stan-data">Default priors, Stan code and Stan data<a class="anchor" aria-label="anchor" href="#default-priors-stan-code-and-stan-data"></a></h2>
    <p>For more information about the default priors in <strong>bmm</strong> and about who to extract the Stan code and data generated by bmm and #'   brms, see <a href="https://venpopov.github.io/bmm/articles/bmm_extract_info.html">the online article</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="miscellaneous">Miscellaneous<a class="anchor" aria-label="anchor" href="#miscellaneous"></a></h2>
    <p>Type <code><a href="https://venpopov.github.io/bmm/reference">help(package=bmm)</a></code> for a full list of available help topics.</p>
<p><strong>fit_model()</strong> is a deprecated alias for <strong>bmm()</strong>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Frischkorn, G. T., &amp; Popov, V. (2023). A tutorial for estimating
mixture models for visual working memory tasks in brms: Introducing the
Bayesian Measurement Modeling  (bmm) package for R.
https://doi.org/10.31234/osf.io/umt57</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="supported_models.html">supported_models()</a></code>, <code><a href="https://paulbuerkner.com/brms/reference/brm.html" class="external-link">brms::brm()</a></code>, <a href="default_prior.bmmformula.html">default_prior()</a>, <code><a href="bmmformula.html">bmmformula()</a></code>, <a href="stancode.bmmformula.html">stancode()</a>, <a href="standata.bmmformula.html">standata()</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># isTRUE(Sys.getenv("BMM_EXAMPLES"))</span></span></span>
<span class="r-in"><span><span class="co"># generate artificial data from the Signal Discrimination Model</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="SDMdist.html">rsdm</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define formula</span></span></span>
<span class="r-in"><span><span class="va">ff</span> <span class="op">&lt;-</span> <span class="fu"><a href="bmmformula.html">bmmformula</a></span><span class="op">(</span><span class="va">c</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">kappa</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit the model</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">bmm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">ff</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">dat</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="fu"><a href="sdm.html">sdm</a></span><span class="op">(</span>resp_error <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  cores <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>  backend <span class="op">=</span> <span class="st">"cmdstanr"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vencislav Popov, Gidon T. Frischkorn.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

