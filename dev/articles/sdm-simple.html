<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bmm">
<title>The Signal Discrimination Model (SDM) • bmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The Signal Discrimination Model (SDM)">
<meta property="og:description" content="bmm">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bmm</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../dev-notes/index.html">Develop</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/venpopov/bmm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>The Signal Discrimination Model (SDM)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/venpopov/bmm/blob/HEAD/vignettes/sdm-simple.Rmd" class="external-link"><code>vignettes/sdm-simple.Rmd</code></a></small>
      <div class="d-none name"><code>sdm-simple.Rmd</code></div>
    </div>

    
    
<style type="text/css">
  div.main-container {
    max-width: 800px !important;
  }
  
  p {
    margin-top: 1.5em ;
    margin-bottom: 1.5em ;
  }
</style>
<div class="section level2" number="1">
<h2 id="introduction-to-the-model">
<span class="header-section-number">1</span> Introduction to the model<a class="anchor" aria-label="anchor" href="#introduction-to-the-model"></a>
</h2>
<p>The Signal Discrimination Model is a measurement model for continuous reproduction tasks in the visual working memory domain. The model was originally introduced by <span class="citation">Oberauer (2023)</span>. As other measurement models for continuous reproduction tasks, it’s goal is to model the distribution of angular response errors.</p>
<p>The model assumes that when a test probe appears, all possible responses on the circle (<span class="math inline">\(\theta\)</span>) are activated with a strength that depends on the distance between the
feature stored in memory (<span class="math inline">\(\mu\)</span>) and the response options. Formally, this is given by the following activation function:</p>
<p><span class="math display" id="eq:activation-function">\[\begin{align}
S(\theta) &amp;= c \cdot \frac{\exp(\kappa \cdot \cos(y-\mu))}{2\pi I_0(\kappa)}
\tag{1.1}
\end{align}\]</span></p>
<p>where <span class="math inline">\(c\)</span> is the memory strength parameter, <span class="math inline">\(\kappa\)</span> is the precision parameter, and <span class="math inline">\(I_0\)</span> is the modified Bessel function of the first kind of order 0. Thus, the activation function follows a von Mises distribution, weigthed by a memory strength parameter.</p>
<p>The activation of response options is corrupted by noise, which is assumed to follow a Gumbel distribution. Then the response is the option with the highest activation value:</p>
<p><span class="math display" id="eq:argmax">\[\begin{align}
Pr(\theta) = argmax(S(\theta) + \epsilon) \\ \epsilon \sim Gumbel(0,1)
\tag{1.2}
\end{align}\]</span>
This is equivalent to the following softmax function (also known as the exponentiated Luce’s choice rule):</p>
<p><span class="math display" id="eq:ptheta-exps">\[\begin{align}
Pr(\theta) = \frac{\exp(S(\theta)}{\sum_{i=1}^{n} \exp(S(\theta_i))}
\tag{1.3}
\end{align}\]</span>
where n is the number of response options, most often 360 in typical visual working memory experiments.</p>
<p>In summary, the model assumes that response errors come from the following distribution, where <span class="math inline">\(\mu = 0\)</span>:</p>
<p><span class="math display" id="eq:dsdm-oberauer">\[\begin{align}
\Large{f(\theta\ |\ \mu,c,\kappa) = \frac{e^ {c \ \frac{e^{k\ cos(\theta-\mu)}}{2\pi I_o(k)}}}{Z}}
\tag{1.4}
\end{align}\]</span>
and Z is the normalizing constant to ensure that the probability mass sums to 1.</p>
</div>
<div class="section level2" number="2">
<h2 id="parametrization-in-the-bmm-package">
<span class="header-section-number">2</span> Parametrization in the <code>bmm</code> package<a class="anchor" aria-label="anchor" href="#parametrization-in-the-bmm-package"></a>
</h2>
<p>In the <code>bmm</code> package we use a different parametrization of Equation <a href="#eq:dsdm-oberauer">(1.4)</a>. The parametrization is chosen for numerical stability and efficiency. Three features of <a href="#eq:dsdm-oberauer">(1.4)</a> make it difficult to work with in practice. First, the modified bessel function <span class="math inline">\(I_0\)</span> increases rapidly, often leading to numerical overflow. Second, the bessel function is expensive to compute, and estimating this model with MCMC methods can be slow. Third, the normalizing constant in the denominator requires summing 360 terms, which is also slow.</p>
<p>To address these issues, we use the following parametrization of the SDM distribution:</p>
<p><span class="math display" id="eq:dsdm-bmm">\[\begin{align}

   \Large{f(\theta\ |\ \mu,c,\kappa) = \frac{
        e^{c \ \sqrt{\frac{k}{2\pi}} e^{k \ (cos(\theta-\mu)-1)}}
        }{Z}}
\tag{2.1}
\end{align}\]</span></p>
<p>This parametrization is derived from the known approximation of the modified bessel function for large <span class="math inline">\(k\)</span> (<span class="citation">Abramowitz, Stegun, and Romer (1988)</span>):</p>
<p><span class="math display" id="eq:bessel-approx">\[\begin{align}
I_0(\kappa) \sim ~ \frac{e^{\kappa}}{\sqrt{2\pi \kappa}}, \ \ \ \ \kappa \rightarrow \infty
\tag{2.2}
\end{align}\]</span></p>
<p>If needed, the <span class="math inline">\(c\)</span> parameter of the original formulation by Oberauer (2023) can be computed by:</p>
<p><span class="math display" id="eq:parametrization">\[\begin{align}

c_{oberauer} = c_{bmm} \ e^{-\kappa} I_0(\kappa)\sqrt{2 \pi \kappa}

\tag{2.3}
\end{align}\]</span></p>
<p>This parametrization does not change the predicted shape of the distribution, but it produces slightly different values of <span class="math inline">\(c\)</span> for small values of <span class="math inline">\(kappa\)</span>. The parametrization is the default in the <code>bmm</code> package.</p>
<p>A second optimization concerns the calculation of the normalizing constant <span class="math inline">\(Z\)</span>. The original model assumed that responses can only be one of 360 discrete values, resulting in a probability mass function. In <code>bmm</code> we treat the response variable as continuous, which makes <span class="math inline">\(f(\theta)\)</span> a probability density function. This means that we can calculate the normalizing constant <span class="math inline">\(Z\)</span> by integrating <span class="math inline">\(f(\theta)\)</span> over the entire circle:</p>
<p><span class="math display" id="eq:z-integral">\[\begin{align}
Z = \int_{-\pi}^{\pi} f(\theta) d\theta
\tag{2.4}
\end{align}\]</span></p>
<p>This integral cannot be expressed in closed form, but it can be approximated using numerical integration methods. The results between the discrete and continuous formulations are nearly identical, for large number of response options (as in typical applications), but not when the number of response options is small, for example in 4-AFC tasks.</p>
</div>
<div class="section level2" number="3">
<h2 id="fitting-the-model-with-bmm">
<span class="header-section-number">3</span> Fitting the model with <code>bmm</code><a class="anchor" aria-label="anchor" href="#fitting-the-model-with-bmm"></a>
</h2>
<p>Begin by loading the <code>bmm</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/venpopov/bmm" class="external-link">bmm</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3" number="3.1">
<h3 id="generating-simulated-data">
<span class="header-section-number">3.1</span> Generating simulated data<a class="anchor" aria-label="anchor" href="#generating-simulated-data"></a>
</h3>
<p>If you already have data you want to fit, you can skip this section. For the current illustration, we will generate some simulated data from equation <a href="#eq:dsdm-bmm">(2.1)</a> with known parameters. <code>bmm</code> provides density functions in typical R style, with the prefix <code>d</code> for density (<code>dsdm</code>), <code>p</code> for the cumulative distribution function (<code>psdm</code>), <code>q</code> for the quantile function (<code>qsdm</code>), and (<code>rsdm</code>) for generating random deviates. Here’s how to simulate data from the SDM distribution for three conditions:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define parameters:</span></span>
<span><span class="va">cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">kappas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate data from the model</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/SDMdist.html">rsdm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, mu<span class="op">=</span><span class="fl">0</span>, c <span class="op">=</span> <span class="va">cs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, kappa <span class="op">=</span> <span class="va">kappas</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, parametrization <span class="op">=</span> <span class="st">"sqrtexp"</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="../reference/SDMdist.html">rsdm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, mu<span class="op">=</span><span class="fl">0</span>, c <span class="op">=</span> <span class="va">cs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, kappa <span class="op">=</span> <span class="va">kappas</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, parametrization <span class="op">=</span> <span class="st">"sqrtexp"</span><span class="op">)</span>,</span>
<span>       <span class="fu"><a href="../reference/SDMdist.html">rsdm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, mu<span class="op">=</span><span class="fl">0</span>, c <span class="op">=</span> <span class="va">cs</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, kappa <span class="op">=</span> <span class="va">kappas</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, parametrization <span class="op">=</span> <span class="st">"sqrtexp"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>,</span>
<span>                  cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This gives us the following distribution of response errors, with lines overlaying the predicted density generated with <code>dsdm</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate predicted SDM density:</span></span>
<span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span>, length.out<span class="op">=</span><span class="fl">1000</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>                 cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">cs</span>, each<span class="op">=</span><span class="fl">1000</span><span class="op">)</span>,</span>
<span>                 kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">kappas</span>, each<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dd</span><span class="op">$</span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDMdist.html">dsdm</a></span><span class="op">(</span><span class="va">dd</span><span class="op">$</span><span class="va">y</span>, mu<span class="op">=</span><span class="fl">0</span>, c<span class="op">=</span><span class="va">dd</span><span class="op">$</span><span class="va">c</span>, kappa<span class="op">=</span><span class="va">dd</span><span class="op">$</span><span class="va">kappa</span>, parametrization <span class="op">=</span> <span class="st">"sqrtexp"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare labels for plots</span></span>
<span><span class="va">par_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span><span class="op">)</span>,</span>
<span>                         c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                         kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">par_labels</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'c = '</span>, <span class="va">par_labels</span><span class="op">$</span><span class="va">c</span>, <span class="st">'\nkappa = '</span>, <span class="va">par_labels</span><span class="op">$</span><span class="va">kappa</span><span class="op">)</span></span>
<span>                 </span>
<span><span class="co"># plot the data and the predicted density</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="va">cond</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">0.1</span>, position <span class="op">=</span> <span class="st">"identity"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">cond</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dd</span>, fun<span class="op">=</span><span class="va">dsdm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simulated data from the SDM distribution"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Response error (radians)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">par_labels</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">-</span><span class="va">pi</span>, y<span class="op">=</span><span class="fl">0.5</span>, label<span class="op">=</span><span class="va">label</span><span class="op">)</span>, hjust<span class="op">=</span><span class="fl">0</span>, vjust<span class="op">=</span><span class="fl">0</span>, size<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="sdm-simple_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div class="section level3" number="3.2">
<h3 id="estimating-the-model-with-bmm">
<span class="header-section-number">3.2</span> Estimating the model with <code>bmm</code><a class="anchor" aria-label="anchor" href="#estimating-the-model-with-bmm"></a>
</h3>
<p>To estimate the parameters of the SDM distribution, we can use the <code><a href="../reference/fit_model.html">fit_model()</a></code> function. First, let’s specify the model formula. We want <code>c</code> and <code>kappa</code> to vary over conditions. By default, the first line of the formula specifies the response variable and it should be <code>y ~ 1</code> - this fixes the location parameter <span class="math inline">\(\mu\)</span> to 0. The next two lines of the formula specify how the parameters vary over conditions. In this case, we want them to vary over the <code>cond</code> variable, so we use <code>c ~ 0 + cond</code> and <code>kappa ~ 0 + cond</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ff</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paul-buerkner.github.io/brms/reference/brmsformula.html" class="external-link">bf</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>               <span class="va">c</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">cond</span>,</span>
<span>               <span class="va">kappa</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">cond</span><span class="op">)</span></span></code></pre></div>
<p>Then we specify the model, which in this case is just <code><a href="../reference/SDM.html">sdmSimple()</a></code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDM.html">sdmSimple</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we can fit the model. We strongly recommend using <code>cmdstanr</code> as a backend for fitting the SDM model, as it is much faster and more stable than the default <code>rstan</code> backend for this particular model. Here’s how to fit the model with <code>cmdstanr</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">ff</span>,</span>
<span>                 data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>                 model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                 parallel <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                 chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                 iter<span class="op">=</span><span class="fl">2000</span>,</span>
<span>                 backend<span class="op">=</span><span class="st">'cmdstanr'</span><span class="op">)</span></span></code></pre></div>
<p>The model takes about 30 seconds to fit after it is compiled. Here we just preload the results of the model fit, but in practice you would have to wait for the model to finish fitting.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"sdm_vignette_fit.rds"</span>, package<span class="op">=</span><span class="st">'bmm'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can now inspect the results of the model fit:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Family: sdm_simple </span></span>
<span><span class="co">#&gt;   Links: mu = identity; c = log; kappa = log </span></span>
<span><span class="co">#&gt; Formula: y ~ 1 </span></span>
<span><span class="co">#&gt;          c ~ 0 + cond</span></span>
<span><span class="co">#&gt;          kappa ~ 0 + cond</span></span>
<span><span class="co">#&gt;    Data: .x2 (Number of observations: 3000) </span></span>
<span><span class="co">#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 4000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Population-Level Effects: </span></span>
<span><span class="co">#&gt;             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; Intercept       0.00      0.00     0.00     0.00   NA       NA       NA</span></span>
<span><span class="co">#&gt; c_condA         0.70      0.12     0.48     0.94 1.00     1916     2179</span></span>
<span><span class="co">#&gt; c_condB         2.37      0.18     2.06     2.77 1.00     1787     1230</span></span>
<span><span class="co">#&gt; c_condC         0.64      0.06     0.52     0.76 1.00     1977     2277</span></span>
<span><span class="co">#&gt; kappa_condA     0.99      0.19     0.60     1.34 1.00     1919     2260</span></span>
<span><span class="co">#&gt; kappa_condB    -0.13      0.18    -0.51     0.18 1.00     1780     1102</span></span>
<span><span class="co">#&gt; kappa_condC     2.15      0.11     1.93     2.37 1.00     1919     2140</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sample(hmc). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>We see that all Rhat values are less than 1.01, which is a good sign that the chains have converged. In principle you have to do more inspection, but let us see the estimated parameters. The model uses a log-link function for the <code>c</code> and <code>kappa</code> parameters, so we have to exponentiate the coefficients to get the estimated parameters:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;     c_condA     c_condB     c_condC kappa_condA kappa_condB kappa_condC </span></span>
<span><span class="co">#&gt;    2.015877   10.713433    1.896317    2.679769    0.880320    8.553107</span></span></code></pre></div>
<p>which are close to the true values we used to simulate the data:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">par_labels</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">#&gt;   cond c kappa</span></span>
<span><span class="co">#&gt; 1    A 2     3</span></span>
<span><span class="co">#&gt; 2    B 9     1</span></span>
<span><span class="co">#&gt; 3    C 2     8</span></span></code></pre></div>
<p>We can see that even though the estimated parameters are close, they are not exactly the same as the true parameters. To get a better picture, we can plot the estimated posterior distributions of the parameters:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/tidybayes/" class="external-link">tidybayes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract the posterior draws</span></span>
<span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu">tidybayes</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/tidybayes/reference/tidy_draws.html" class="external-link">tidy_draws</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">draws</span>, <span class="va">b_c_condA</span><span class="op">:</span><span class="va">b_kappa_condC</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot posterior with original parameters overlayed as diamonds</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">draws</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">value</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="va">par</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tidybayes</span><span class="fu">::</span><span class="fu"><a href="http://mjskay.github.io/tidybayes/reference/tidybayes-deprecated.html" class="external-link">stat_halfeyeh</a></span><span class="op">(</span>normalize <span class="op">=</span> <span class="st">"groups"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'b_c_condA'</span>,<span class="st">'b_c_condB'</span>,<span class="st">'b_c_condC'</span>,</span>
<span>                                       <span class="st">'b_kappa_condA'</span>,<span class="st">'b_kappa_condB'</span>,<span class="st">'b_kappa_condC'</span><span class="op">)</span>,</span>
<span>                                value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cs</span>, <span class="va">kappas</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">value</span>,<span class="va">par</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>             shape <span class="op">=</span> <span class="st">"diamond"</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>lim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="sdm-simple_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>The true parameters all lie within the 50% credible intervals, which is a good sign that the model is able to recover the true parameters from the data.</p>
<p>As a final step, we can plot our data again, adding another line overlay with the density predicted by the estimated parameters:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate predicted SDM density:</span></span>
<span><span class="va">ddest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span>, length.out<span class="op">=</span><span class="fl">1000</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>                 cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">1000</span><span class="op">)</span>,</span>
<span>                 kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare labels for plots</span></span>
<span><span class="va">par_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span><span class="op">)</span>,</span>
<span>                         c_est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                         kappa_est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                         c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                         kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">par_labels</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'c = '</span>, <span class="va">par_labels</span><span class="op">$</span><span class="va">c</span>, <span class="st">' (estimate = '</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">par_labels</span><span class="op">$</span><span class="va">c_est</span>,<span class="fl">2</span><span class="op">)</span>, <span class="st">')\n'</span>,</span>
<span>                           <span class="st">'kappa = '</span>, <span class="va">par_labels</span><span class="op">$</span><span class="va">kappa</span>, <span class="st">' (estimate = '</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">par_labels</span><span class="op">$</span><span class="va">kappa_est</span>,<span class="fl">2</span><span class="op">)</span>, <span class="st">')'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ddest</span><span class="op">$</span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SDMdist.html">dsdm</a></span><span class="op">(</span><span class="va">ddest</span><span class="op">$</span><span class="va">y</span>, mu<span class="op">=</span><span class="fl">0</span>, c<span class="op">=</span><span class="va">ddest</span><span class="op">$</span><span class="va">c</span>, kappa<span class="op">=</span><span class="va">ddest</span><span class="op">$</span><span class="va">kappa</span>, parametrization <span class="op">=</span> <span class="st">"sqrtexp"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the data and the predicted density</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="va">cond</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">0.1</span>, position <span class="op">=</span> <span class="st">"identity"</span>, alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">cond</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dd</span>, fun<span class="op">=</span><span class="va">dsdm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">d</span><span class="op">)</span>, color<span class="op">=</span><span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">ddest</span>, fun<span class="op">=</span><span class="va">dsdm</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">d</span><span class="op">)</span>, color<span class="op">=</span><span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Simulated data from the SDM distribution"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Response error (radians)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">par_labels</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">-</span><span class="va">pi</span>, y<span class="op">=</span><span class="fl">0.9</span>, label<span class="op">=</span><span class="va">label</span><span class="op">)</span>, hjust<span class="op">=</span><span class="fl">0</span>, vjust<span class="op">=</span><span class="fl">0</span>, size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="sdm-simple_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>The histograms represent the data, the black lines represent the predicted density from the true parameters, and the red lines represent the predicted density from the estimated parameters. We can see that the estimated parameters are able to capture the main features of the data.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-abramowitz1988handbook" class="csl-entry">
Abramowitz, Milton, Irene A Stegun, and Robert H Romer. 1988. <span>“Handbook of Mathematical Functions with Formulas, Graphs, and Mathematical Tables.”</span> American Association of Physics Teachers.
</div>
<div id="ref-Oberauer_2023" class="csl-entry">
Oberauer, Klaus. 2023. <span>“Measurement Models for Visual Working Memory—a Factorial Model Comparison.”</span> <em>Psychological Review</em> 130 (3): 841–52. <a href="https://doi.org/10.1037/rev0000328" class="external-link">https://doi.org/10.1037/rev0000328</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Vencislav Popov, Gidon Frischkorn.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
