<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Mixture models for visual working memory • bmm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mixture models for visual working memory">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bmm</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="https://venpopov.github.io/bmm/dev-notes/index.html">Develop</a></li>
<li class="nav-item"><a class="nav-link" href="https://venpopov.github.io/bmm/parameter-recovery/index.html">Parameter recovery</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/venpopov/bmm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mixture models for visual working memory</h1>
                        <h4 data-toc-skip class="author">Ven Popov</h4>
                        <h4 data-toc-skip class="author">Gidon Frischkorn</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/venpopov/bmm/blob/develop/vignettes/articles/bmm_mixture_models.Rmd" class="external-link"><code>vignettes/articles/bmm_mixture_models.Rmd</code></a></small>
      <div class="d-none name"><code>bmm_mixture_models.Rmd</code></div>
    </div>

    
    
<style type="text/css">
div.main-container {
max-width: 850px !important;
}

p {
margin-top: 1.5em ;
margin-bottom: 1.5em ;
}
.author{
    display: none;
}
</style>
<div class="section level2" number="1">
<h2 id="introduction-to-the-models">
<span class="header-section-number">1</span> Introduction to the models<a class="anchor" aria-label="anchor" href="#introduction-to-the-models"></a>
</h2>
<p>The two-parameter mixture model <span class="citation">(Zhang and Luck 2008)</span> and the three-parameter mixture model <span class="citation">(Bays, Catalao, and Husain 2009)</span> are measurement models for continuous reproduction tasks in the visual working memory domain (for details on the task, see <a href="https://venpopov.github.io/bmm/articles/bmm_vwm_crt.html">the online article</a>. As other measurement models for continuous reproduction tasks, their goal is to model the distribution of angular response errors.</p>
<p>The <em>two-parameter mixture model</em> (<code><a href="../reference/mixture2p.html">?mixture2p</a></code>) distinguishes two memory states that lead to responses with a mixture of two different distributions of angular errors. The two states are:</p>
<ol style="list-style-type: decimal">
<li><p>having a representation of the cued object with a certain precision of its feature in visual working memory (solid blue distribution in Figure <a href="#fig:mixture-models">1.1</a>)</p></li>
<li><p>having no representation in visual working memory and thus guessing a random response (dashed red distribution).</p></li>
</ol>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:mixture-models"></span>
<img src="assets%2Fmixture_models_illustration.jpg" alt="Mixtures of response distributions" width="450"><p class="caption">
Figure 1.1: Mixtures of response distributions
</p>
</div>
<p>Responses based on a noisy memory representation of the correct feature come from a circular normal distribution (i.e., von Mises) centered on the correct feature value, while guessing responses come from a uniform distribution along the entire circle:</p>
<p><span class="math display">\[
p(\theta) = p_{mem} \cdot \text{vM}(\theta; \mu, \kappa) + (1-p_{mem}) \cdot \text{Uniform}(\theta; -\pi, \pi) \\
\]</span>
<span class="math display">\[
p_{guess} = 1-p_{mem} \\
\]</span>
<span class="math display">\[
vM(\theta; \mu, \kappa) = \frac{e^{\kappa \cos(\theta - \mu)}}{2\pi I_0(\kappa)}
\]</span></p>
<p>where <span class="math inline">\(\theta\)</span> is the response angle, <span class="math inline">\(p_{mem}\)</span> is the probability that responses come from memory of target feature, <span class="math inline">\(\mu\)</span> is the mean of the von Mises distribution representing the target feature, and <span class="math inline">\(\kappa\)</span> is the concentration parameter of the von Mises distribution, representing the precision of the target memory representation.</p>
<p>The <em>three-parameter mixture model</em> (<code><a href="../reference/mixture3p.html">?mixture3p</a></code>) adds a third state: confusing the cued object with another object shown during encoding and thus reporting the feature of the other object (long dashed green distribution in Figure <a href="#fig:mixture-models">1.1</a>). Responses from this state are sometimes called non-target responses or swap errors. The non-target responses also come from a von Mises distribution centered on the feature of the non-target object. The probability of non-target responses is represented by the parameter <span class="math inline">\(p_{nt}\)</span>, and the complete model is:</p>
<p><span class="math display">\[
p(\theta) = p_{mem} \cdot \text{vM}(\theta; \mu_t, \kappa) + p_{nt} \cdot \frac{\sum_{i=1}^{n} \text{vM}(\theta; \mu_{i}, \kappa)}{n} + (1-p_{mem}-p_{nt}) \cdot \text{Uniform}(\theta; -\pi, \pi) \\
\]</span>
<span class="math display">\[
p_{guess} = 1-p_{mem}-p_{nt}
\]</span></p>
<p>where <span class="math inline">\(\mu_{t}\)</span> is the location of the target feature, <span class="math inline">\(\mu_{i}\)</span> is the location of the i-th non-target feature, <span class="math inline">\(n\)</span> is the number of non-target features.</p>
<p>In most applications of the model, the responses are coded as the angular error relative to the target feature. The same is true for the non-target memory representations, which are assumed to be centered on the target feature, and the precision of the non-target memory representation is assumed to be the same as the precision of the target memory representation. This is the version of the model implemented in the <code>bmm</code> package:</p>
<p><span class="math display">\[
p(\theta) = p_{mem} \cdot \text{vM}(\theta; 0, \kappa) + p_{nt} \cdot \frac{\sum_{i=1}^{n}  \text{vM}(\theta; \mu_{i}-\mu_t, \kappa)}{n} + (1-p_{mem}-p_{nt}) \cdot \text{Uniform}(\theta; -\pi, \pi)
\]</span></p>
</div>
<div class="section level2" number="2">
<h2 id="the-data">
<span class="header-section-number">2</span> The data<a class="anchor" aria-label="anchor" href="#the-data"></a>
</h2>
<p>Begin by loading the <code>bmm</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/venpopov/bmm" class="external-link">bmm</a></span><span class="op">)</span></span></code></pre></div>
<p>For this example, we will analyze data from <span class="citation">Bays, Catalao, and Husain (2009)</span>. The data is included in the <code>mixtur</code> R package and can be loaded with the following command:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install the mixtur package if you haven't done so</span></span>
<span><span class="co"># install.packages("mixtur")</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">mixtur</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/mixtur/man/bays2009_full.html" class="external-link">bays2009_full</a></span></span></code></pre></div>
<p>The data contains the following columns:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="3%">
<col width="2%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="6%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
<col width="12%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">id</th>
<th align="right">set_size</th>
<th align="right">duration</th>
<th align="right">response</th>
<th align="right">target</th>
<th align="right">non_target_1</th>
<th align="right">non_target_2</th>
<th align="right">non_target_3</th>
<th align="right">non_target_4</th>
<th align="right">non_target_5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">321</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2000</td>
<td align="right">0.846</td>
<td align="right">0.100</td>
<td align="right">3.025</td>
<td align="right">-0.665</td>
<td align="right">2.054</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">322</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2000</td>
<td align="right">-1.634</td>
<td align="right">-0.845</td>
<td align="right">2.985</td>
<td align="right">2.633</td>
<td align="right">2.103</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">323</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">100</td>
<td align="right">-1.684</td>
<td align="right">-1.951</td>
<td align="right">0.312</td>
<td align="right">-1.924</td>
<td align="right">0.622</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">324</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">100</td>
<td align="right">0.713</td>
<td align="right">0.133</td>
<td align="right">1.502</td>
<td align="right">3.089</td>
<td align="right">-0.958</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">325</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2000</td>
<td align="right">1.317</td>
<td align="right">1.439</td>
<td align="right">-2.675</td>
<td align="right">-1.191</td>
<td align="right">1.970</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">326</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">2000</td>
<td align="right">-1.316</td>
<td align="right">-0.384</td>
<td align="right">0.845</td>
<td align="right">0.274</td>
<td align="right">-0.465</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>where:</p>
<ul>
<li>
<code>id</code> is a unique identifier for each participant</li>
<li>
<code>set_size</code> is the number of items presented in the memory array</li>
<li>
<code>response</code> the participant’s recollection of the target orientation in radians</li>
<li>
<code>target</code> the feature value of the target in radians</li>
<li>
<code>non_target_1</code> to <code>non_target5</code> are the feature values of the non-targets in radians</li>
</ul>
<p>The trials vary in <code>set_size</code> (1, 2, 3 or 6), and also vary in encoding duration.</p>
<p>To fit the mixture models with <code>bmm</code>, first we have to make sure that the data is in the correct format. The response variable should be in radians and represent the <em>angular error relative to the target</em>, and the non-target variables should be in radians and be <em>centered relative to the target</em>. You can find these requirements in the help topic for <code><a href="../reference/mixture2p.html">?mixture2p</a></code> and <code><a href="../reference/mixture3p.html">?mixture3p</a></code>.</p>
<p>In this dataset, the response and non-target variables are already in radians, but they is not centered relative to the target. We can check that by plotting the response distribution. Because memory items are selected at random on each trial, the non-centered responses show a uniform distribution:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.5</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Response distribution"</span>, x <span class="op">=</span> <span class="st">"Response error (radians)"</span>, y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bmm_mixture_models_files/figure-html/unnamed-chunk-4-1.jpeg" width="400" style="display: block; margin: auto;"></p>
<p>We can center the response and non-target variables by subtracting the target value from them. We can do this with the <code>mutate</code> function from the <code>dplyr</code> package. We also need to make sure that the response is in the range of <span class="math inline">\((-\pi, \pi)\)</span>, and the non-target variables are in the range of <span class="math inline">\((-\pi, \pi)\)</span>. We can do this with the <code>wrap</code> function from the <code>bmm</code> package. As we can see from the new plot, the response distribution is now centered on 0.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">dat_preprocessed</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>error <span class="op">=</span> <span class="fu"><a href="../reference/wrap.html">wrap</a></span><span class="op">(</span><span class="va">response</span> <span class="op">-</span> <span class="va">target</span><span class="op">)</span>,</span>
<span>         non_target_1 <span class="op">=</span> <span class="fu"><a href="../reference/wrap.html">wrap</a></span><span class="op">(</span><span class="va">non_target_1</span> <span class="op">-</span> <span class="va">target</span><span class="op">)</span>,</span>
<span>         non_target_2 <span class="op">=</span> <span class="fu"><a href="../reference/wrap.html">wrap</a></span><span class="op">(</span><span class="va">non_target_2</span> <span class="op">-</span> <span class="va">target</span><span class="op">)</span>,</span>
<span>         non_target_3 <span class="op">=</span> <span class="fu"><a href="../reference/wrap.html">wrap</a></span><span class="op">(</span><span class="va">non_target_3</span> <span class="op">-</span> <span class="va">target</span><span class="op">)</span>,</span>
<span>         non_target_4 <span class="op">=</span> <span class="fu"><a href="../reference/wrap.html">wrap</a></span><span class="op">(</span><span class="va">non_target_4</span> <span class="op">-</span> <span class="va">target</span><span class="op">)</span>,</span>
<span>         non_target_5 <span class="op">=</span> <span class="fu"><a href="../reference/wrap.html">wrap</a></span><span class="op">(</span><span class="va">non_target_5</span> <span class="op">-</span> <span class="va">target</span><span class="op">)</span>,</span>
<span>         set_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">set_size</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat_preprocessed</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>bins<span class="op">=</span><span class="fl">60</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Response distribution"</span>, x <span class="op">=</span> <span class="st">"Response error (radians)"</span>, y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">set_size</span><span class="op">)</span></span></code></pre></div>
<p><img src="bmm_mixture_models_files/figure-html/unnamed-chunk-5-1.jpeg" width="800" style="display: block; margin: auto;"></p>
<p>From the plot above we can also see that performace gets substantially worse with increasing set size. Now, we can fit the two mixture models two understand what is driving this pattern.</p>
</div>
<div class="section level2" number="3">
<h2 id="fitting-the-2-parameter-mixture-model-with-bmm">
<span class="header-section-number">3</span> Fitting the 2-parameter mixture model with <code>bmm</code><a class="anchor" aria-label="anchor" href="#fitting-the-2-parameter-mixture-model-with-bmm"></a>
</h2>
<p>To fit the two-parameter mixture model, we need to specify the model formula and the model. For the model formula we use the <code>brms</code> package’s <code>bf</code> function.
For all linear model formulas in brms, the left side of an equation refers to the to-be predicted variable or parameter and the right side specifies the variables used to predict it.</p>
<p>In this example, we want to fit a model in which both the probability of memory responses and the precision of the memory responses vary with set size. We also want
the effect of set size to vary across participants.</p>
<p>The model formula has three components:</p>
<ol style="list-style-type: decimal">
<li>The response variable <code>error</code> is predicted by a constant term, which is internally fixed to have a mean of 0</li>
<li>The precision parameter <code>kappa</code> is predicted by set size, and the effect of set size varies across participants</li>
<li>The mixture weight<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;code&gt;brms&lt;/code&gt; does not directly estimate the probabilities that each response comes from each distribution (e.g. &lt;span class="math inline"&gt;\(p_{mem}\)&lt;/span&gt; and &lt;span class="math inline"&gt;\(p_{guess}\)&lt;/span&gt;). Instead, brms estimates mixing proportions that are weights applied to each of the mixture distributions and they are transformed into probabilities (e.g. &lt;span class="math inline"&gt;\(p_{mem}\)&lt;/span&gt; and &lt;span class="math inline"&gt;\(p_{guess}\)&lt;/span&gt;) using a softmax normalization. To get &lt;span class="math inline"&gt;\(p_{mem}\)&lt;/span&gt; we can use the softmax function, that is: &lt;span class="math inline"&gt;\(p_{mem} = \frac{exp(\theta_{target})}{1+exp(\theta_{target})}\)&lt;/span&gt;&lt;/p&gt;'><sup>1</sup></a> for memory responses <code>thetat</code> is predicted by set size, and the effect of set size varies across participants.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bmmformula.html">bmf</a></span><span class="op">(</span><span class="va">thetat</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">set_size</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">set_size</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>          <span class="va">kappa</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">set_size</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">set_size</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then we specify the model as simply as:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixture2p.html">mixture2p</a></span><span class="op">(</span>resp_error <span class="op">=</span> <span class="st">"error"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we fit the model with the <code><a href="../reference/bmm.html">bmm()</a></code> function. The fit model function uses
the <code>brms</code> package to fit the model, so you can pass to it any argument that you would pass to the <code>brm</code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bmm.html">bmm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">ff</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat_preprocessed</span>,</span>
<span>  model <span class="op">=</span> <span class="va">model</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">'cmdstanr'</span>,</span>
<span>  file <span class="op">=</span> <span class="st">"assets/bmmfit_mixture2p_vignette"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2" number="4">
<h2 id="results-of-the-2-parameter-mixture-model">
<span class="header-section-number">4</span> Results of the 2-parameter mixture model<a class="anchor" aria-label="anchor" href="#results-of-the-2-parameter-mixture-model"></a>
</h2>
<p>We can now inspect the model fit:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>Warning<span class="sc">:</span> There were <span class="dv">1</span> divergent transitions after warmup. Increasing adapt_delta above <span class="fl">0.8</span> may help. See http<span class="sc">:</span><span class="er">//</span>mc<span class="sc">-</span>stan.org<span class="sc">/</span>misc<span class="sc">/</span>warnings.html<span class="co">#divergent-transitions-after-warmup</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #AF5FFF;">  Model: </span><span style="color: #FF875F;">mixture2p</span>(resp_error = "error") 
<span style="color: #AF5FFF;">  Links: </span>mu1 = tan_half; kappa = log; thetat = identity 
<span style="color: #AF5FFF;">Formula: </span>mu1 = 0
         kappa ~ 0 + set_size + (0 + set_size || id)
         thetat ~ 0 + set_size + (0 + set_size || id) 
<span style="color: #AF5FFF;">   Data:</span> dat_preprocessed (Number of observations: 7271)
<span style="color: #AF5FFF;">  Draws: </span>4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

<span style="color: #00BB00;">Multilevel Hyperparameters:
</span>~id (Number of levels: 12) 
                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(kappa_set_size1)      0.36      0.10     0.22     0.60 1.00     1267     2370
sd(kappa_set_size2)      0.21      0.08     0.08     0.39 1.00     1302     1020
sd(kappa_set_size4)      0.34      0.11     0.18     0.60 1.00     1924     2711
sd(kappa_set_size6)      0.43      0.15     0.21     0.79 1.00     1779     2444
sd(thetat_set_size1)     0.57      0.45     0.03     1.73 1.00     1265     1452
sd(thetat_set_size2)     0.93      0.29     0.51     1.64 1.00     1747     2568
sd(thetat_set_size4)     0.95      0.27     0.55     1.63 1.00     1412     2109
sd(thetat_set_size6)     0.67      0.20     0.39     1.15 1.00     1643     2310

<span style="color: #00BB00;">Regression Coefficients:
</span>                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
kappa_set_size1      2.89      0.12     2.66     3.12 1.00     1406     1716
kappa_set_size2      2.40      0.08     2.24     2.56 1.00     2632     2527
kappa_set_size4      2.08      0.12     1.84     2.32 1.00     2426     2690
kappa_set_size6      1.94      0.15     1.65     2.25 1.00     2517     2627
thetat_set_size1     4.53      0.40     3.89     5.43 1.00     2316     1088
thetat_set_size2     2.56      0.31     1.94     3.17 1.00     1658     1999
thetat_set_size4     1.08      0.29     0.50     1.67 1.00     1312     1735
thetat_set_size6     0.32      0.21    -0.08     0.75 1.00     1502     2120

<span style="color: #00BB00;">Constant Parameters:
</span>                  Value
mu1_Intercept      0.00

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).
</code></pre>
<p>The summary shows the estimated fixed effects for the precision and the mixture weight, as well as the estimated random effects for the precision and the mixture weight. All Rhat values are close to 1, which is a good sign that the chains have converged. The effective sample sizes are also high, which means that the chains have mixed well.</p>
<p>We now want to understand the estimated parameters.</p>
<ul>
<li>
<code>kappa</code> is coded within <code>brms</code> with a log-link function, so we need to exponentiate the estimates to get the precision parameter. We can further use the <code>k2sd</code> function to convert the precision parameter to the standard deviation units.</li>
<li>
<code>thetat</code> is the mixture weight for memory responses. As described in footnote 1, we can use the softmax function to get the probability of memory responses.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract the fixed effects from the model and determine the rows that contain</span></span>
<span><span class="co"># the relevant parameter estimates</span></span>
<span><span class="va">fixedEff</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">thetat</span> <span class="op">&lt;-</span> <span class="va">fixedEff</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"thetat"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">fixedEff</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">kappa</span> <span class="op">&lt;-</span> <span class="va">fixedEff</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"kappa_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">fixedEff</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># transform parameters because brms uses special link functions</span></span>
<span><span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">)</span></span>
<span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/k2sd.html">k2sd</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> </span>
<span><span class="va">p_mem</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">thetat</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">thetat</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">thetat</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>Our estimates for kappa over set_size are:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kappa</span></span>
<span><span class="co">#&gt;                  Estimate Est.Error      Q2.5    Q97.5</span></span>
<span><span class="co">#&gt; kappa_set_size1 17.974163  1.126196 14.314425 22.69904</span></span>
<span><span class="co">#&gt; kappa_set_size2 11.069807  1.079969  9.431975 12.87640</span></span>
<span><span class="co">#&gt; kappa_set_size4  7.981807  1.126819  6.305204 10.17838</span></span>
<span><span class="co">#&gt; kappa_set_size6  6.979520  1.162236  5.189384  9.47424</span></span></code></pre></div>
<p>Standard deviation:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Set size "</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sd</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Set size 1 Set size 2 Set size 4 Set size 6 </span></span>
<span><span class="co">#&gt;      0.239      0.308      0.366      0.394</span></span></code></pre></div>
<p>Probability that responses comes from memory:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">p_mem</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Set size "</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p_mem</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;            Estimate Est.Error  Q2.5 Q97.5</span></span>
<span><span class="co">#&gt; Set size 1    0.989     0.598 0.980 0.996</span></span>
<span><span class="co">#&gt; Set size 2    0.928     0.577 0.874 0.960</span></span>
<span><span class="co">#&gt; Set size 4    0.746     0.571 0.623 0.841</span></span>
<span><span class="co">#&gt; Set size 6    0.579     0.553 0.480 0.680</span></span></code></pre></div>
<p>It is even better to visualize the entire posterior distribution of the parameters.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/tidybayes/" class="external-link">tidybayes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract the posterior draws</span></span>
<span><span class="va">draws</span> <span class="op">&lt;-</span> <span class="fu">tidybayes</span><span class="fu">::</span><span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/tidy_draws.html" class="external-link">tidy_draws</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">draws_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">draws</span>, <span class="va">b_thetat_set_size1</span><span class="op">:</span><span class="va">b_thetat_set_size6</span><span class="op">)</span></span>
<span><span class="va">draws_kappa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">draws</span>, <span class="va">b_kappa_set_size1</span><span class="op">:</span><span class="va">b_kappa_set_size6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># transform parameters because brms uses special link functions</span></span>
<span><span class="va">draws_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">draws_theta</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">draws_theta</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">draws_kappa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">draws_kappa</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot posterior</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">draws_theta</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">value</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"b_thetat_set_size"</span>, <span class="st">""</span>, <span class="va">par</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tidybayes</span><span class="fu">::</span><span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/tidybayes-deprecated.html" class="external-link">stat_halfeyeh</a></span><span class="op">(</span>normalize <span class="op">=</span> <span class="st">"groups"</span>, orientation <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Probability of memory response"</span>, x <span class="op">=</span> <span class="st">"Set size"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">draws_kappa</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">value</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>value <span class="op">=</span> <span class="fu"><a href="../reference/k2sd.html">k2sd</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"b_kappa_set_size"</span>, <span class="st">""</span>, <span class="va">par</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">par</span>,<span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">tidybayes</span><span class="fu">::</span><span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/tidybayes-deprecated.html" class="external-link">stat_halfeyeh</a></span><span class="op">(</span>normalize <span class="op">=</span> <span class="st">"groups"</span>, orientation <span class="op">=</span> <span class="st">"vertical"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Memory imprecision (SD)"</span>, x <span class="op">=</span> <span class="st">"Set size"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="bmm_mixture_models_files/figure-html/unnamed-chunk-14-1.jpeg" width="400"><img src="bmm_mixture_models_files/figure-html/unnamed-chunk-14-2.jpeg" width="400"></p>
<p>where the black dot represents the median of the posterior distribution, the thick line represents the 50% credible interval, and the thin line represents the 95% credible interval.</p>
</div>
<div class="section level2" number="5">
<h2 id="fitting-the-3-parameter-mixture-model-with-bmm">
<span class="header-section-number">5</span> Fitting the 3-parameter mixture model with <code>bmm</code><a class="anchor" aria-label="anchor" href="#fitting-the-3-parameter-mixture-model-with-bmm"></a>
</h2>
<p>Fitting the 3-parameter mixture model is very similar. We have an extra parameter <code>thetant</code> that represents the mixture weight for non-target responses<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;because now we have three mixture weights, you will need later to calculate the probability of target responses as &lt;span class="math inline"&gt;\(p_{mem} = \frac{exp(\theta_{target})}{1+exp(\theta_{target})+exp(\theta_{nontarget})}\)&lt;/span&gt;, the probability of non-target responses as &lt;span class="math inline"&gt;\(p_{nt} =\frac{exp(\theta_{nontarget})}{1+exp(\theta_{target})+exp(\theta_{nontarget})}\)&lt;/span&gt;, and the probability of guessing as &lt;span class="math inline"&gt;\(p_{guess} = 1-p_{mem}-p_{nt}\)&lt;/span&gt;&lt;/p&gt;'><sup>2</sup></a>. We also need to specify the names of the non-target variables and the set_size<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;When the set_size varies in an experiment, provide the name of the variable containing the set_size information. If the set size is the same for all trials, provide a number, e.g. &lt;code&gt;set_size=4&lt;/code&gt;&lt;/p&gt;"><sup>3</sup></a> variable in the <code>mixture3p</code> function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bmmformula.html">bmf</a></span><span class="op">(</span></span>
<span>  <span class="va">thetat</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">set_size</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">set_size</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  <span class="va">thetant</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">set_size</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">set_size</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span>,</span>
<span>  <span class="va">kappa</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">set_size</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0</span> <span class="op">+</span> <span class="va">set_size</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixture3p.html">mixture3p</a></span><span class="op">(</span>resp_error <span class="op">=</span> <span class="st">"error"</span>, nt_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'non_target_'</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, set_size <span class="op">=</span> <span class="st">'set_size'</span><span class="op">)</span></span></code></pre></div>
<p>Then we run the model just like before:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit3p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bmm.html">bmm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">ff</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat_preprocessed</span>,</span>
<span>  model <span class="op">=</span> <span class="va">model</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">'cmdstanr'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The rest of the analysis is the same as for the 2-parameter model. We can inspect the model fit, extract the parameter estimates, and visualize the posterior distributions.</p>
<p>In the above example we specified all column names for the non_targets explicitely via <code>paste0('non_target_',1:5)</code>. Alternatively, you can use a regular expression to match the non-target feature columns in the dataset. This is useful when the non-target feature columns are named in a consistent way, e.g. <code>non_target_1</code>, <code>non_target_2</code>, <code>non_target_3</code>, etc. For example, you can specify the model a few different ways via regular expressions:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixture3p.html">mixture3p</a></span><span class="op">(</span>resp_error <span class="op">=</span> <span class="st">"error"</span>, </span>
<span>                   nt_features <span class="op">=</span> <span class="st">"non_target_[1-5]"</span>, </span>
<span>                   set_size <span class="op">=</span> <span class="st">'set_size'</span>, </span>
<span>                   regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixture3p.html">mixture3p</a></span><span class="op">(</span>resp_error <span class="op">=</span> <span class="st">"error"</span>, </span>
<span>                   nt_features <span class="op">=</span> <span class="st">"non_target_"</span>, </span>
<span>                   set_size <span class="op">=</span> <span class="st">'set_size'</span>, </span>
<span>                   regex <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Bays_Catalao_Husain_2009" class="csl-entry">
Bays, Paul M., Raquel F. G. Catalao, and Masud Husain. 2009. <span>“The Precision of Visual Working Memory Is Set by Allocation of a Shared Resource.”</span> <em>Journal of Vision</em> 9 (10): 7–7. <a href="https://doi.org/10.1167/9.10.7" class="external-link">https://doi.org/10.1167/9.10.7</a>.
</div>
<div id="ref-Zhang_Luck_2008" class="csl-entry">
Zhang, Weiwei, and Steven J. Luck. 2008. <span>“Discrete Fixed-Resolution Representations in Visual Working Memory.”</span> <em>Nature</em> 453 (7192): 233–35. <a href="https://doi.org/10.1038/nature06860" class="external-link">https://doi.org/10.1038/nature06860</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vencislav Popov, Gidon T. Frischkorn.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
