<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>The Multinomial / Memory Measurement Model (M3) • bmm</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The Multinomial / Memory Measurement Model (M3)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bmm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item"><a class="nav-link" href="https://venpopov.github.io/bmm/dev-notes/index.html">Develop</a></li>
<li class="nav-item"><a class="nav-link" href="https://venpopov.github.io/bmm/parameter-recovery/index.html">Parameter recovery</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/venpopov/bmm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>The Multinomial / Memory Measurement Model (M3)</h1>
                        <h4 data-toc-skip class="author">Gidon Frischkorn</h4>
                        <h4 data-toc-skip class="author">Chenyu Li</h4>
                        <h4 data-toc-skip class="author">Isabel Courage</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/venpopov/bmm/blob/develop/vignettes/articles/bmm_m3.Rmd" class="external-link"><code>vignettes/articles/bmm_m3.Rmd</code></a></small>
      <div class="d-none name"><code>bmm_m3.Rmd</code></div>
    </div>

    
    
<style type="text/css">
div.main-container {
max-width: 800px !important;
}

p {
margin-top: 1.5em ;
margin-bottom: 1.5em ;
}
.author{
    display: none;
}
</style>
<div class="section level2" number="1">
<h2 id="introduction-to-the-model">
<span class="header-section-number">1</span> Introduction to the model<a class="anchor" aria-label="anchor" href="#introduction-to-the-model"></a>
</h2>
<p>The multinomial / memory measurement model (<code>m3</code>) is a computational measurement model that was introduced for working memory tasks with categorical responses <span class="citation">(Oberauer and Lewandowsky 2019)</span>. Such task typically use verbal and visual materials, for example: letters, words, objects, and digits. The only prerequisite for using the <code>m3</code> is that the responses can be grouped into separate response categories. For each of these response categories the model predicts the frequency of selecting one item of a category as a function of continuous activation strengths.</p>
<p>Withing the domain of working memory, the <code>m3</code> most commonly distinguishes two different activation dimensions:</p>
<ol style="list-style-type: decimal">
<li>Memory strength of individual elements or items presented during a single trial, often labelled item memory</li>
<li>Memory strength of relations, relying on temporary bindings, often labelled binding or source memory</li>
</ol>
<p>The <code>m3</code> also allows to include additional hypothetical processes that might increase or diminishing these activation strengths due to experimental manipulations, such as manipulating encoding time or distraction in the domain of memory.</p>
<div class="section level3" number="1.1">
<h3 id="basic-assumptions-of-the-m3">
<span class="header-section-number">1.1</span> Basic assumptions of the <code>m3</code><a class="anchor" aria-label="anchor" href="#basic-assumptions-of-the-m3"></a>
</h3>
<p>The <code>m3</code> builds on two general assumptions:</p>
<ol style="list-style-type: decimal">
<li>Choosing a response (in memory tasks = memory recall) represents a competitive selection from a set of response candidates</li>
<li>Selection from the candidate set is a function of the relative activation of each candidate representation at test</li>
</ol>
<p>The set of response candidates can either a) follow naturally from the stimulus material, for example all digits from 1 to 9 or all letters from the alphabet, b) be given in the experimental procedure implementing recall as the selection from <code>n</code> response alternatives (n-AFC), or c) be constructed by the individual performing the task. Generally, we recommend focusing on the first and the second use case, as these provide pretty simple and straightforward implementations of the <code>m3</code>.</p>
<p>To simplify the use of the <code>m3</code>, we do not model the activation of each response candidate seperately, but we group the response candidates into categories that all share the same sources of activation. For example, consider a simple short term memory task (simple span task) in which subjects are asked to remember digits in their serial order and are then cued with a random serial position to retrieve the respective digit. In this task, participants can either recall the correct digit that was associated with the cued position, often labelled the item-in-position. But they could also recall any of the other digits they had to remember, often labelled items from other list positions. Finally, they could also recall a digit that was not part of the memory set at all, usually labelled not-presented items or lures. Thus, we have three categories of responses in this task: correct responses or items-in position (labelled <span class="math inline">\(correct\)</span>), other list items (labelled <span class="math inline">\(other\)</span>), and not presented items (labelled <span class="math inline">\(npl\)</span>).</p>
<p>After we have decided on the relevant response categories, we need to specify which activation sources contribute towards each category. For the above simple short term memory tasks, these would most reasonably be:</p>
<p><span class="math display">\[
\begin{align}
correct &amp; = b + a + c\\
other &amp; = b + a\\
npl &amp; = b
\end{align}
\]</span></p>
<p>In this case, <span class="math inline">\(b\)</span> is the baseline activation or background noise, that can be understood as the activation of all digits, because participants know that they have to remember digits in general. The parameter <span class="math inline">\(a\)</span> is the memory strength for items, or general activation, for all items that need to be remembered in the current trial. And parameter <span class="math inline">\(c\)</span> is the memory strength for relations, or context activation, that arises from the context cue of retrieving the cued serial position.</p>
</div>
<div class="section level3" number="1.2">
<h3 id="choice-rules-in-the-m3">
<span class="header-section-number">1.2</span> Choice Rules in the <code>m3</code><a class="anchor" aria-label="anchor" href="#choice-rules-in-the-m3"></a>
</h3>
<p>The activation for each category is then translated into probabilities of recalling one item or response from each category with a normalization function as a choice rule. In <code>bmm</code> we have implemented two choice rules, that are different implementations of Luce’s choice axiom:</p>
<ol style="list-style-type: decimal">
<li>Simple normalization (<code>"simple"</code>)</li>
</ol>
<p>This choice rule normalizes the absolute activation over the sum of the activation of all items:</p>
<p><span class="math display">\[
p_i = \frac{n_i \cdot A_i}{\sum^n_{j = 1} n_j \cdot A_j}
\]</span></p>
<p>In this normalization the probability <span class="math inline">\(p_i\)</span> of recalling an item from the category <span class="math inline">\(i\)</span> results from the number of candidates in the category <span class="math inline">\(n_i\)</span> times the activation of the category <span class="math inline">\(A_i\)</span> as specified in the activation formulas above. This total activation of the category <span class="math inline">\(i\)</span> then gets divided by the sum of all categories <span class="math inline">\(n\)</span> and their activation that arises as the product of the number of items in the category <span class="math inline">\(n_j\)</span> times the activation of that category <span class="math inline">\(A_j\)</span>.</p>
<p>The rationale underlying this choice rule is that it provides a meaningful zero point. That is, if any category has zero activation the probability for choosing this category will be zero.</p>
<ol start="2" style="list-style-type: decimal">
<li>Softmax</li>
</ol>
<p>The <code>softmax</code> choice rule normalizes the exponentiated activation of each category over the sum of all exponentiated activations:</p>
<p><span class="math display">\[
p_i = \frac{n_i \cdot e^{A_i}}{\sum^n_{j = 1} n_j \cdot e^{A_j}}
\]</span></p>
<p>This choice rule can be interpreted as an n-alternative SDT model over the different response candidates with a Gumbel (or double-exponential) noise distribution.</p>
<p>Finally, the model then links the response frequencies <span class="math inline">\(Y\)</span> for each response category to the probabilities <span class="math inline">\(p\)</span> using a multinomial distribution with the total number of trials:</p>
<p><span class="math display">\[
Y \sim multinomial(p, trials)
\]</span></p>
</div>
</div>
<div class="section level2" number="2">
<h2 id="parametization-of-the-m3-in-bmm">
<span class="header-section-number">2</span> Parametization of the <code>m3</code> in <code>bmm</code><a class="anchor" aria-label="anchor" href="#parametization-of-the-m3-in-bmm"></a>
</h2>
<p>Given its introduction in the domain of working memory, there are currently three versions of the <code>m3</code> model implemented in <code>bmm</code>:</p>
<ul>
<li>the <code>m3</code> for simple span tasks (<code>version = "ss"</code>)</li>
<li>the <code>m3</code> for complex span tasks (<code>version = "cs"</code>)</li>
<li>a fully <em>custom</em> <code>m3</code> that can be adapted to any kind of task with categorical responses (<code>version = "custom"</code>).</li>
</ul>
<div class="section level3" number="2.1">
<h3 id="m3-for-simple-and-complex-span-tasks">
<span class="header-section-number">2.1</span> <code>m3</code> for simple and complex span tasks<a class="anchor" aria-label="anchor" href="#m3-for-simple-and-complex-span-tasks"></a>
</h3>
<p>The simple and complex span versions of the <code>m3</code> implement the activation functions outlined in Formula 1 (simple span, see also the activation formulas above) and Formula 3 (complex span) in <span class="citation">Oberauer and Lewandowsky (2019)</span>. In addition to the three response categories of the simple span task, the complex span model distinguished two additional response categories: distractors in or close to the cued position (<span class="math inline">\(dist_{context}\)</span>), and distractors from other or far away positions (<span class="math inline">\(dist_{other}\)</span>). Thus, the <code>m3</code> for complex span tasks requires that you use distractors that could be potentially recalled.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Traditional complex span tasks, such as the operation span or reading span task are thus not suited for the &lt;code&gt;m3&lt;/code&gt;, as the distractors are different from the to-be-remembered items. For example, in the operation span task, participants are instructed to-remember a set of letters in order while judging math equations to be correct or incorrect in-between the letters. As it is unlikely, that participants would recall digits that are part of the math equations instead of letters, such tasks are not suited to distinguish processes related to the distractor processing. You could still fit the &lt;code&gt;m3&lt;/code&gt; for simple span tasks to these data, this model would however not provide any insight on the way distractors are encoded and processed in working memory.&lt;/p&gt;"><sup>1</sup></a></p>
<p>The activation equation for the <code>m3</code> for complex span tasks are as follows<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Please note that assuming that item and context activation are filtered equally for the distractors is just one way that filtering might reduce the activation of distractors. More recent research on the removal of information from working memory suggests that item and binding memory might not be reduced equally. This would require assuming different filtering parameter &lt;span class="math inline"&gt;\(f_a\)&lt;/span&gt; for the general activation, and &lt;span class="math inline"&gt;\(f_c\)&lt;/span&gt; for the context activation. This would require specifying a &lt;code&gt;custom&lt;/code&gt; M3.&lt;/p&gt;'><sup>2</sup></a>:</p>
<p><span class="math display">\[
\begin{align}
corr &amp; = b + a + c \\
other &amp; = b + a \\
dist_{c} &amp; = b + f \cdot a + f \cdot c \\
dist_{o} &amp; = b + f \cdot a \\
npi &amp; = b
\end{align}
\]</span></p>
<p>For both the simple and complex span <code>m3</code> you do not have to specify the activation formulas for the different categories. You only need to provide linear or non-linear predictor formulas for the different parameters of the respective <code>m3</code> version. Using these models you can investigate how different activation sources vary over experimental manipulations or get theoretically grounded indicators of individual differences of the different activation sources.</p>
</div>
<div class="section level3" number="2.2">
<h3 id="custom-m3-for-tasks-with-categorical-responses">
<span class="header-section-number">2.2</span> Custom <code>m3</code> for tasks with categorical responses<a class="anchor" aria-label="anchor" href="#custom-m3-for-tasks-with-categorical-responses"></a>
</h3>
<p>The <code>version = "custom"</code> of the <code>m3</code> allows you to specify custom activation functions for memory tasks beyond simple and complex span tasks. Although the <code>m3</code> was conceived as a measurement model for working memory. The <code>m3</code> framework can be generalized towards any decision paradigm involving categorical decision that could be explained by continuous activation for difference categorical responses. Therefore, we have relabeled the model from “memory measurement model” to “multinomial measurement model” to reflect the broader application beyond the domain of working memory.</p>
<p>For example, you could use a custom <code>m3</code> to dissociate different activation sources and cognitive processes contributing to memory performance in memory updating tasks. In addition, to recalling the correct item, items from other positions, or items not presented at all during the current trial, participants can also recall <em>outdated items</em> that have been updated during the trial in such tasks. The frequency of recalling such items, can inform us of the processes contributing towards replacing the initially encoded item with the new item. One such model is discussed in <span class="citation">Oberauer and Lewandowsky (2019)</span>.</p>
<p>For the <code>version = "custom"</code> of the <code>m3</code> you have to provide the activation functions for all response categories. Apart from that you then still provide linear prediction formulas for predicting the different parameters by experimental conditions. For details, please see the section <a href="#fitting">Fitting the <code>m3</code></a></p>
</div>
<div class="section level3" number="2.3">
<h3 id="parameter-scaling-the-m3">
<span class="header-section-number">2.3</span> Parameter Scaling the <code>m3</code><a class="anchor" aria-label="anchor" href="#parameter-scaling-the-m3"></a>
</h3>
<p>Generally, one of the <code>m3</code> parameters has to be fixed to set the scaling of the model. In <code>bmm</code> the default is to fix the background noise parameter <code>b</code>. Thus the values of the other parameters should be interpreted relative to the background noise. The value <code>b</code> will be fixed to depends on the choice rule you choose for fitting the model. For the <code>simple</code> choice rule, <code>b</code> will be fixed to <code>0.1</code>, for the <code>softmax</code> choice rule, <code>b</code> will be fixed to <code>0</code>.</p>
<p>We chose two fix the background noise <code>b</code> for scaling for two reasons:</p>
<ol style="list-style-type: decimal">
<li>Fixing the background noise is similar to fixing noise parameters in other cognitive measurement models, such as the diffusion constant <code>s</code>, or the standard deviation of the noise added to the signal or noise distribution in SDT.</li>
<li>In <code>bmm</code> we require that all activation formulas contain at least the background noise <code>b</code>. This ensures that if there is no activation from any other source, the model predicts random guessing.</li>
</ol>
<p>In principle, you can decide to fix another parameter for scaling. Then you need to specify which parameter should be fixed in the <code>bmmformula</code> and additionally provide a formula to predict the background noise <code>b</code>.</p>
</div>
</div>
<div class="section level2" number="3">
<h2 id="fitting-the-m3">
<span class="header-section-number">3</span> <a name="fitting"></a> Fitting the M3<a class="anchor" aria-label="anchor" href="#fitting-the-m3"></a>
</h2>
<p>To fit the <code>m3</code> in <code>bmm</code>, we need to perform the same three steps as for all models fitted in <code>bmm</code>:</p>
<ol style="list-style-type: decimal">
<li>Load data and format it to match the requirements for the <code>m3</code>
</li>
<li>Specify the <code>bmmformula</code>
</li>
<li>Create the <code>bmmodel</code> object that links the model to the variables required for fitting in the data</li>
</ol>
<p>For the <code>ss</code> and <code>cs</code> version of the <code>m3</code> these steps are practically identical to fitting any other <code>bmmodel</code>. The <code>custom</code> version of the <code>m3</code> requires some additional <code>bmmformula</code> to specify the custom activation formulas for each response category. This will be explained below.</p>
<div class="section level3" number="3.1">
<h3 id="the-data">
<span class="header-section-number">3.1</span> The data<a class="anchor" aria-label="anchor" href="#the-data"></a>
</h3>
<p>Let’s begin by loading the <code>bmm</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/venpopov/bmm" class="external-link">bmm</a></span><span class="op">)</span></span></code></pre></div>
<p>For this example, we will be using the data from the first experiment from <span class="citation">Oberauer and Lewandowsky (2019)</span>. This data set is part of the <code>bmm</code> package as <code>oberauer_lewandowsky_2019_e1</code></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">oberauer_lewandowsky_2019_e1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # A tibble: 6 × 10</span></span>
<span><span class="co">#&gt;      ID cond             corr other   npl  dist n_corr n_other n_dist n_npl</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;fct&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1 new distractors    78    11     3     8      1       4      5     5</span></span>
<span><span class="co">#&gt; 2     1 old reordered      73    23     4    NA      1       4      0    10</span></span>
<span><span class="co">#&gt; 3     1 old same           95     4     1    NA      1       4      0    10</span></span>
<span><span class="co">#&gt; 4     2 new distractors    49    23     1    27      1       4      5     5</span></span>
<span><span class="co">#&gt; 5     2 old reordered      54    44     7    NA      1       4      0    10</span></span>
<span><span class="co">#&gt; 6     2 old same           64    23     8    NA      1       4      0    10</span></span></code></pre>
<p>The data contains the following variables:</p>
<ul>
<li>
<code>ID</code>: an integer uniquely identifying each participant in the experiment</li>
<li>
<code>cond</code>: a factor distinguishing three experimental conditions that varied the type of distractors</li>
<li>
<code>corr</code>, <code>other</code>, <code>dist</code>, and <code>npl</code>: The frequencies of responding with one item of the respective response categories</li>
<li>
<code>n_corr</code>, <code>n_other</code>, <code>n_dist</code>, and <code>n_npl</code>: The number of response candidates in each response categories for each experimental condition</li>
</ul>
<p>This data set already contains all the information required to fit the M3 model. But if you have a data set that is in long format and contains which <code>response_category</code> the <code>response</code> in each trial belongs to, then you need to aggregate the data and sum the number of responses for each category in each of the experimental conditions that the model should be fitted to.</p>
</div>
<div class="section level3" number="3.2">
<h3 id="specifying-the-bmmformula-for-the-m3">
<span class="header-section-number">3.2</span> Specifying the <code>bmmformula</code> for the <code>m3</code><a class="anchor" aria-label="anchor" href="#specifying-the-bmmformula-for-the-m3"></a>
</h3>
<p>After having set up the data, we specify the <code>bmmformula</code>. For the <code>ss</code> and <code>cs</code> versions of the <code>m3</code> the <code>bmmformula</code> should contain only the linear model formulas for each of the model parameters. These could look like this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example formula for version = ss</span></span>
<span><span class="va">ss_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bmmformula.html">bmf</a></span><span class="op">(</span></span>
<span>  <span class="va">c</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>  <span class="va">a</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># example formula for version = cs</span></span>
<span><span class="va">cs_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bmmformula.html">bmf</a></span><span class="op">(</span></span>
<span>  <span class="va">c</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>  <span class="va">a</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>  <span class="va">f</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For the <code>custom</code> version of the <code>m3</code> the <code>bmmformula</code> additionally needs to contain the activation formulas for each response category. This is done by using the label of each response category and predicting it by the activation function that you want to use for this category. The activation function can be any linear combination of different activation sources or non-linear function of activation sources or model parameters and other variables in the data, as exemplified in the more complex models in <span class="citation">Oberauer and Lewandowsky (2019)</span>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cat_label</span> <span class="op">~</span> <span class="va">activation_function</span></span></code></pre></div>
<p>If we wanted to implement the model proposed by <span class="citation">Oberauer and Lewandowsky (2019)</span> for this data set, we need to specified four activation formulas for the response categories <code>corr</code>, <code>other</code>, <code>dist</code>, and <code>npl</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">act_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bmmformula.html">bmf</a></span><span class="op">(</span></span>
<span>  <span class="va">corr</span> <span class="op">~</span> <span class="va">b</span> <span class="op">+</span> <span class="va">a</span> <span class="op">+</span> <span class="va">c</span>,</span>
<span>  <span class="va">other</span> <span class="op">~</span> <span class="va">b</span> <span class="op">+</span> <span class="va">a</span>,</span>
<span>  <span class="va">dist</span> <span class="op">~</span> <span class="va">b</span> <span class="op">+</span> <span class="va">d</span>,</span>
<span>  <span class="va">npl</span> <span class="op">~</span> <span class="va">b</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>How you label the parameters in the activation formula is up to you, except for using underscores in the variable names and that the parameter <code>b</code> is reserved for the baseline activation or background noise that is required to be part of the activation function of each response category. Apart from that, we recommend using short labels to avoid parsing errors with special symbols.</p>
<p>Based on the parameter labels that we used in these activation functions, we can then specify the linear formulas for each parameter:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">par_formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bmmformula.html">bmf</a></span><span class="op">(</span></span>
<span>  <span class="va">c</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>  <span class="va">a</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>  <span class="va">d</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">ID</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then, we can combine both formulas into one by adding them using the <code>+</code> operator. Alternatively you can include all formulas in one call to <code>bmmformula</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">full_formula</span> <span class="op">&lt;-</span> <span class="va">act_formulas</span> <span class="op">+</span> <span class="va">par_formulas</span></span>
<span></span>
<span><span class="co"># pass all formulas in one call</span></span>
<span><span class="va">full_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bmmformula.html">bmf</a></span><span class="op">(</span></span>
<span>  <span class="va">corr</span> <span class="op">~</span> <span class="va">b</span> <span class="op">+</span> <span class="va">a</span> <span class="op">+</span> <span class="va">c</span>,</span>
<span>  <span class="va">other</span> <span class="op">~</span> <span class="va">b</span> <span class="op">+</span> <span class="va">a</span>,</span>
<span>  <span class="va">dist</span> <span class="op">~</span> <span class="va">b</span> <span class="op">+</span> <span class="va">d</span>,</span>
<span>  <span class="va">npl</span> <span class="op">~</span> <span class="va">b</span>,</span>
<span>  <span class="va">c</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">||</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>  <span class="va">a</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">cond</span> <span class="op">||</span> <span class="va">ID</span><span class="op">)</span>,</span>
<span>  <span class="va">d</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">||</span> <span class="va">ID</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3" number="3.3">
<h3 id="setting-up-the-bmmodel-object-for-the-m3">
<span class="header-section-number">3.3</span> Setting up the <code>bmmodel</code> object for the <code>m3</code><a class="anchor" aria-label="anchor" href="#setting-up-the-bmmodel-object-for-the-m3"></a>
</h3>
<p>The last thing we need to do before fitting the <code>m3</code> to the data is set up the <code>bmmodel</code> object. For this we need to call the <code>m3</code> function and provide the relevant information for the model. This entails:</p>
<ul>
<li>the name of the response categories</li>
<li>the number of response options in each category or the variable names that contain the number of response options in the data</li>
<li>the choice rule, if not explicitly called <code>bmm</code> will use the <code>softmax</code> as default</li>
<li>the <code>m3</code> version, if not explicitly selected <code>bmm</code> will use the <code>custom</code> version as default</li>
</ul>
<p>Thus, a basic set up of an <code>m3</code> object looks like this:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/m3.html">m3</a></span><span class="op">(</span>resp_cats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"corr"</span>,<span class="st">"other"</span>,<span class="st">"dist"</span>,<span class="st">"npl"</span><span class="op">)</span>,</span>
<span>               num_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n_corr"</span>,<span class="st">"n_other"</span>,<span class="st">"n_dist"</span>,<span class="st">"n_npl"</span><span class="op">)</span>,</span>
<span>               choice_rule <span class="op">=</span> <span class="st">"simple"</span>,</span>
<span>               version <span class="op">=</span> <span class="st">"custom"</span><span class="op">)</span></span></code></pre></div>
<p>For the <code>custom</code> version, you additionally need to provide the <code>links</code> that should be used for each of the model parameters.The <code>links</code> ensure that model parameters stay in the correct value range. In particular for the <code>simple</code> choice rule it is essential, that all activation are positive. Thus, we recommend using <code>log</code> link functions for all parameters that represent activation sources, such as general or context activation, especially when using the <code>simple</code> choice rule.</p>
<p>Based on the provided links for the model parameters, <code>bmm</code> will set <code>default_priors</code> that aim at a reasonable parameter range. We recommend that you check the priors set for the <code>custom</code> version of the <code>m3</code> andconsider what parameter ranges are reasonable for the different model parameters and provide <code>default_priors</code> for all of them. For detailed information on priors in <code>bmm</code> please see the <code>vignette("extract_info")</code>. In short, you can provide priors for intercepts as <code>main</code> and for effects as <code>effects</code>.</p>
<p>Setting up a <code>m3</code> object including these info looks like this:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_links</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  c <span class="op">=</span> <span class="st">"log"</span>, a <span class="op">=</span> <span class="st">"log"</span>, d <span class="op">=</span> <span class="st">"log"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">my_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/m3.html">m3</a></span><span class="op">(</span>resp_cats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"corr"</span>,<span class="st">"other"</span>,<span class="st">"dist"</span>,<span class="st">"npl"</span><span class="op">)</span>,</span>
<span>               num_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n_corr"</span>,<span class="st">"n_other"</span>,<span class="st">"n_dist"</span>,<span class="st">"n_npl"</span><span class="op">)</span>,</span>
<span>               choice_rule <span class="op">=</span> <span class="st">"simple"</span>,</span>
<span>               version <span class="op">=</span> <span class="st">"custom"</span>,</span>
<span>               links <span class="op">=</span> <span class="va">my_links</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print default priors determined based on link functions</span></span>
<span><span class="fu"><a href="../reference/default_prior.bmmformula.html">default_prior</a></span><span class="op">(</span><span class="va">full_formula</span>, <span class="va">data</span>, <span class="va">my_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Default priors for each parameter will be specified internally based on the provided link function.</span></span>
<span><span class="co">#&gt; Please check if the used priors are reasonable for your application</span></span>
<span><span class="co">#&gt;                 prior class             coef group resp dpar nlpar   lb   ub</span></span>
<span><span class="co">#&gt;        normal(0, 0.5)     b condoldreordered                     a &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        normal(0, 0.5)     b      condoldsame                     a &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd                                      a    0     </span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd                     ID               a    0     </span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd condoldreordered    ID               a    0     </span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd      condoldsame    ID               a    0     </span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd        Intercept    ID               a    0     </span></span>
<span><span class="co">#&gt;                (flat)     b                                      b          </span></span>
<span><span class="co">#&gt;        normal(0, 0.5)     b condoldreordered                     c &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        normal(0, 0.5)     b      condoldsame                     c &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd                                      c    0     </span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd                     ID               c    0     </span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd condoldreordered    ID               c    0     </span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd      condoldsame    ID               c    0     </span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd        Intercept    ID               c    0     </span></span>
<span><span class="co">#&gt;                (flat)     b                                      d          </span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd                                      d    0     </span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd                     ID               d    0     </span></span>
<span><span class="co">#&gt;  student_t(3, 0, 2.5)    sd        Intercept    ID               d    0     </span></span>
<span><span class="co">#&gt;        normal(0, 0.5)     b                                      a &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;          normal(1, 1)     b        Intercept                     a &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        normal(0, 0.5)     b                                      c &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;          normal(1, 1)     b        Intercept                     c &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;          normal(1, 1)     b        Intercept                     d &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;         constant(0.1)     b        Intercept                     b &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt;        source</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;       default</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;  (vectorized)</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span>
<span><span class="co">#&gt;          user</span></span></code></pre></div>
</div>
<div class="section level3" number="3.4">
<h3 id="running-bmm-to-estimate-parameters">
<span class="header-section-number">3.4</span> Running <code>bmm</code> to estimate parameters<a class="anchor" aria-label="anchor" href="#running-bmm-to-estimate-parameters"></a>
</h3>
<p>After having set up the <code>data</code>, the <code>bmmformula</code>, and the <code>bmmodel</code>, we can pass all information to <code>bmm</code> to fit the model:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m3_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bmm.html">bmm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">full_formula</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  model <span class="op">=</span> <span class="va">my_model</span>,</span>
<span>  sample_prior <span class="op">=</span> <span class="st">"yes"</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  warmup <span class="op">=</span> <span class="fl">1000</span>, iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  backend <span class="op">=</span> <span class="st">'cmdstanr'</span>,</span>
<span>  file <span class="op">=</span> <span class="st">"assets/bmmfit_m3_vignette"</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Running this model takes about 20 to 40 seconds (depending on the speed of your computer). Using the <code>bmmfit</code> object we can have a quick look at the summary of the fitted model:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m3_fit</span><span class="op">)</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span style="color: #AF5FFF;">  Model: </span><span style="color: #FF875F;">m3</span>(resp_cats = c("corr", "other", "dist", "npl"),
            num_options = c("n_corr", "n_other", "n_dist", "n_npl"),
            choice_rule = "simple",
            version = "custom",
            links = my_links) 
<span style="color: #AF5FFF;">  Links: </span>c = log; a = log; d = log 
<span style="color: #AF5FFF;">Formula: </span>b = 0.1
         a ~ 1 + cond + (1 + cond || ID)
         c ~ 1 + cond + (1 + cond || ID)
         d ~ 1 + (1 || ID)
         corr ~ b + a + c
         other ~ b + a
         dist ~ b + d
         npl ~ b 
<span style="color: #AF5FFF;">   Data:</span> (Number of observations: 120)
<span style="color: #AF5FFF;">  Draws: </span>4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

<span style="color: #00BB00;">Multilevel Hyperparameters:
</span>~ID (Number of levels: 40) 
                       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
sd(a_Intercept)            0.67      0.11     0.48     0.91 1.00     1744
sd(a_condoldreordered)     0.55      0.12     0.33     0.80 1.00     1662
sd(a_condoldsame)          0.27      0.16     0.02     0.59 1.00      864
sd(c_Intercept)            1.62      0.22     1.25     2.10 1.00     1299
sd(c_condoldreordered)     0.23      0.13     0.02     0.49 1.00      795
sd(c_condoldsame)          0.55      0.12     0.34     0.80 1.00     1586
sd(d_Intercept)            0.69      0.12     0.48     0.97 1.00     1623
                       Tail_ESS
sd(a_Intercept)            2269
sd(a_condoldreordered)     2655
sd(a_condoldsame)          1925
sd(c_Intercept)            2410
sd(c_condoldreordered)     1452
sd(c_condoldsame)          2121
sd(d_Intercept)            2530

<span style="color: #00BB00;">Regression Coefficients:
</span>                   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
a_Intercept           -0.30      0.15    -0.60    -0.00 1.00     2112     2304
a_condoldreordered     0.68      0.15     0.37     0.97 1.00     2948     3032
a_condoldsame          0.10      0.14    -0.17     0.36 1.00     3607     3301
c_Intercept            1.60      0.28     1.05     2.14 1.01      466      989
c_condoldreordered     0.03      0.12    -0.22     0.26 1.00     2768     3094
c_condoldsame          0.54      0.14     0.27     0.81 1.00     2887     3132
d_Intercept           -0.45      0.15    -0.75    -0.15 1.00     2203     2615

<span style="color: #00BB00;">Constant Parameters:
</span>                Value
b_Intercept      0.10

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).
</code></pre>
<p>First, we can have a look at the estimated regression coefficients. The first thing we should check is if the sampling converged, this is indicated by all <code>Rhat</code> values being close to one. If you want to do more inspection of the sampling, you can check out the functionality implemented in <code>brms</code>to do this.</p>
<p>The parameter estimates for <code>c</code>, <code>a</code>, and <code>d</code> are estimated using a <code>log</code> link function, so we have to transform these back to the native scale using the <code>exp</code> function:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fixedFX</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/fixed.effects.html" class="external-link">fixef</a></span><span class="op">(</span><span class="va">m3_fit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># print posterior means for the c parameter</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">fixedFX</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">fixedFX</span><span class="op">)</span>,<span class="st">"c_"</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    Estimate Est.Error      Q2.5    Q97.5</span></span>
<span><span class="co">#&gt; c_Intercept        4.930903  1.320092 2.8541063 8.515983</span></span>
<span><span class="co">#&gt; c_condoldreordered 1.025825  1.131547 0.8046311 1.300896</span></span>
<span><span class="co">#&gt; c_condoldsame      1.712454  1.150015 1.3079862 2.251764</span></span>
<span></span>
<span><span class="co"># print posterior means for the a parameter</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">fixedFX</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">fixedFX</span><span class="op">)</span>,<span class="st">"a_"</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     Estimate Est.Error      Q2.5     Q97.5</span></span>
<span><span class="co">#&gt; a_Intercept        0.7431726  1.161537 0.5494346 0.9965668</span></span>
<span><span class="co">#&gt; a_condoldreordered 1.9699622  1.162509 1.4450414 2.6462022</span></span>
<span><span class="co">#&gt; a_condoldsame      1.1053008  1.146248 0.8457697 1.4306108</span></span>
<span></span>
<span><span class="co"># print posterior means for the d parameter</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">fixedFX</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">fixedFX</span><span class="op">)</span>,<span class="st">"d_"</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Estimate Est.Error      Q2.5     Q97.5 </span></span>
<span><span class="co">#&gt; 0.6353230 1.1666323 0.4732908 0.8628526</span></span></code></pre></div>
<p>These estimates differ from the estimates reported by <span class="citation">Oberauer and Lewandowsky (2019)</span>, because we used a <code>log</code> link function, whereas in the original publication an <code>identity</code> link was used. This was done with adding truncation arguments to the priors, to ensure that all activations are positive. In principle, this is possible in <code>bmm</code>, too. However, such an estimation is less numerically stable and efficient. Therefore, we recommend using <code>log</code> links for activation parameters that should be positive.</p>
<div class="section level4" number="3.4.1">
<h4 id="testing-hypothesis">
<span class="header-section-number">3.4.1</span> Testing Hypothesis<a class="anchor" aria-label="anchor" href="#testing-hypothesis"></a>
</h4>
<p>When comparing the differences between the different conditions, the results from <code>bmm</code> converge with those in <span class="citation">Oberauer and Lewandowsky (2019)</span>. The goal of this first experiment was to show a selective influence of different conditions on the <code>c</code> and <code>a</code> parameter. This replicated using the <code>bmm</code> implementation of the proposed <code>m3</code>. To evaluate the posterior differences between the conditions, we can use the <code>hypothesis</code> function from <code>brms</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">post_diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  c_newVoldR <span class="op">=</span> <span class="st">"c_condoldreordered = 0"</span>,</span>
<span>  c_newVoldS <span class="op">=</span> <span class="st">"c_condoldsame = 0"</span>,</span>
<span>  c_oldRVolds <span class="op">=</span> <span class="st">"c_condoldreordered = c_condoldsame"</span>,</span>
<span>  a_newVoldR <span class="op">=</span> <span class="st">"a_condoldreordered = 0"</span>,</span>
<span>  a_newVoldS <span class="op">=</span> <span class="st">"a_condoldsame = 0"</span>,</span>
<span>  a_oldRVolds <span class="op">=</span> <span class="st">"a_condoldreordered = a_condoldsame"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">hyp</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu"><a href="https://paulbuerkner.com/brms/reference/hypothesis.brmsfit.html" class="external-link">hypothesis</a></span><span class="op">(</span><span class="va">m3_fit</span>, <span class="va">post_diff</span><span class="op">)</span></span>
<span><span class="va">hyp</span></span>
<span><span class="co">#&gt; Hypothesis Tests for class b:</span></span>
<span><span class="co">#&gt;    Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star</span></span>
<span><span class="co">#&gt; 1  c_newVoldR     0.03      0.12    -0.22     0.26       3.90      0.80     </span></span>
<span><span class="co">#&gt; 2  c_newVoldS     0.54      0.14     0.27     0.81       0.01      0.01    *</span></span>
<span><span class="co">#&gt; 3 c_oldRVolds    -0.51      0.14    -0.79    -0.23       0.03      0.02    *</span></span>
<span><span class="co">#&gt; 4  a_newVoldR     0.68      0.15     0.37     0.97       0.00      0.00    *</span></span>
<span><span class="co">#&gt; 5  a_newVoldS     0.10      0.14    -0.17     0.36       2.81      0.74     </span></span>
<span><span class="co">#&gt; 6 a_oldRVolds     0.58      0.15     0.28     0.87       0.00      0.00    *</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; 'CI': 90%-CI for one-sided and 95%-CI for two-sided hypotheses.</span></span>
<span><span class="co">#&gt; '*': For one-sided hypotheses, the posterior probability exceeds 95%;</span></span>
<span><span class="co">#&gt; for two-sided hypotheses, the value tested against lies outside the 95%-CI.</span></span>
<span><span class="co">#&gt; Posterior probabilities of point hypotheses assume equal prior probabilities.</span></span></code></pre></div>
<p>These hypothesis will compute the difference between the specified parameters. You can see that the <code>c</code> parameter in the condition <code>oldsame</code> differs from both the <code>new</code> and <code>oldreorderd</code> condition. In contrast the <code>a</code> parameter in the condition <code>oldreordered</code> differs from both the <code>new</code> and the <code>oldsame</code> condition. For these differences the 95% CI does not include zero as indicated by the <code>*</code> at the end of the line.</p>
<p>As we included a statement to also sample the priors using the <code>sample_prior = TRUE</code> option from <code>brms</code> when running the <code>bmm</code>, the <code>Evid.Ratio</code> and <code>Post.Prob</code> column given us the Bayes Factor in favor of the specified hypothesis and the posterior probability for the hypothesis being true.</p>
</div>
<div class="section level4" number="3.4.2">
<h4 id="assessing-model-fit">
<span class="header-section-number">3.4.2</span> Assessing model fit<a class="anchor" aria-label="anchor" href="#assessing-model-fit"></a>
</h4>
<p>For most models implemented in <code>bmm</code> you can easily assess model fit by visually inspecting posterior predictive plots provided by the <code>pp_check</code> function. Unfortunately this function is not yet implemented for multinomial distributional models, such as the <code>m3</code> model.</p>
<p>Nevertheless, there is a pretty simple way to assess model fit for the <code>m3</code> model by obtaining posterior predictions using the <code>tidybayes</code> package. Using the posterior predictive draws for the frequency of selecting each response category, we can compare the observed frequencies to the predicted frequencies. If the model fits the data well, the observed frequencies should be within the 95% credible interval of the predicted frequencies.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/tidybayes/" class="external-link">tidybayes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pp_m3</span> <span class="op">&lt;-</span> <span class="va">m3_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># obtain expected predicted draws</span></span>
<span>  <span class="fu">tidybayes</span><span class="fu">::</span><span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/add_predicted_draws.html" class="external-link">epred_draws</a></span><span class="op">(</span></span>
<span>    newdata <span class="op">=</span> <span class="va">.</span><span class="op">$</span><span class="va">data</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># select only relevant variables</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">cond</span>, <span class="va">nTrials</span>, <span class="va">.draw</span>, <span class="va">.category</span>, <span class="va">.epred</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># calculate the mean predicted values in each condition for each response category</span></span>
<span>  <span class="co"># and each draw</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>.epred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.epred</span><span class="op">/</span><span class="va">nTrials</span><span class="op">)</span>,</span>
<span>            .by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cond</span>, <span class="va">.category</span>, <span class="va">.draw</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># reshape data to match the format of the posterior predictives</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">n_trials</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"corr"</span>,<span class="st">"other"</span>,<span class="st">"dist"</span>,<span class="st">"npl"</span><span class="op">)</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">data_pp</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ID</span>, <span class="va">n_trials</span>, <span class="va">cond</span>, <span class="va">corr</span>, <span class="va">other</span>, <span class="va">dist</span>, <span class="va">npl</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">corr</span>, <span class="va">other</span>, <span class="va">dist</span>, <span class="va">npl</span><span class="op">)</span>, names_to <span class="op">=</span> <span class="st">".category"</span>, values_to <span class="op">=</span> <span class="st">".value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>.value <span class="op">=</span> <span class="va">.value</span><span class="op">/</span><span class="va">n_trials</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># some responses were not possible in some conditions, so we set them to zero</span></span>
<span><span class="va">data_pp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data_pp</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># relabel condition factor for better readability</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">pp_m3</span><span class="op">$</span><span class="va">cond</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"new"</span>, <span class="st">"old shuffled"</span>, <span class="st">"old same"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">data_pp</span><span class="op">$</span><span class="va">cond</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"new"</span>, <span class="st">"old shuffled"</span>, <span class="st">"old same"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot the posterior predictive draws against the observed data</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pp_m3</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">.epred</span>, x <span class="op">=</span> <span class="va">cond</span>, fill <span class="op">=</span> <span class="va">cond</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.category</span> <span class="op">~</span> <span class="va">cond</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">gghalves</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gghalves/man/geom_half_violin.html" class="external-link">geom_half_violin</a></span><span class="op">(</span></span>
<span>    side <span class="op">=</span> <span class="st">"r"</span>, nudge <span class="op">=</span> <span class="fl">0.1</span>, trim <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_pp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span> <span class="op">(</span>y <span class="op">=</span> <span class="va">.value</span><span class="op">)</span>,</span>
<span>               fun.data <span class="op">=</span> <span class="va">mean_se</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Response proportions"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Condition"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Condition"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Model Fit"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Posterior Predicitve vs. Observed Response Proportions"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bmm_m3_files/figure-html/model_fit-1.jpeg" width="80%" style="display: block; margin: auto;"></p>
<p>The generated plot illustrates that the distribution of posterior predictive response distributions is in line with the observed response distributions. This indicates that the model fits the data well. For this particular model, this is unsurprising as it is saturated with respect to the number of parameters and the number of observations.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-oberauerSimpleMeasurementModels2019" class="csl-entry">
Oberauer, Klaus, and Stephan Lewandowsky. 2019. <span>“Simple Measurement Models for Complex Working-Memory Tasks.”</span> <em>Psychological Review</em> 126 (6): 880–932. <a href="https://doi.org/10.1037/rev0000159" class="external-link">https://doi.org/10.1037/rev0000159</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vencislav Popov, Gidon T. Frischkorn.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
